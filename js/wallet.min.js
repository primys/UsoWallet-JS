(function(g){function n(c){return ethereumjs.Wallet.fromV3(JSON.parse(localStorage.getItem(e.getWalletName())),c)}function k(c,a,b,d,g){try{d=d||"";var h=n(c),k=h.getPrivateKey(),l=f.eth.getTransactionCount(h.getChecksumAddressString()),m=f.eth.estimateGas({to:a,data:d}),q=parseInt(m)+parseInt(e.getExtraGasLimit()),r={nonce:l,gasPrice:e.getGasPrice(),gasLimit:q,to:a,value:b,data:d},p=new ethereumjs.Tx(r);p.sign(k);var t=p.serialize();f.eth.sendRawTransaction("0x"+t.toString("hex"),function(a,b){g(a,
b)})}catch(u){g(u.message||"Error")}}var e=g.Values.Ethereum,m=e.getContractAbi(),l=e.getContractAddress(),f=new Web3(new Web3.providers.HttpProvider(e.getNode())),h=f.eth.contract(JSON.parse(m)).at(l);g.Wallet={getAddress:function(){return"0x"+JSON.parse(localStorage.getItem(e.getWalletName())).address},getChecksumAddress:function(c,a){try{var b=n(c).getChecksumAddressString();a(null,b)}catch(d){a(d.message)}},getEthBalance:function(c){f.eth.getBalance(this.getAddress(),function(a,b){a?alert(a):
(a=(new Web3).fromWei(b,"ether"),c(Convert.toBalance(a)))})},getHeight:function(c){f.eth.getBlockNumber(function(a,b){a?alert(a):c(b)})},getUsoBalance:function(c){h.balanceOf.call(this.getAddress(),function(a,b){a?alert(a):(a=Convert.toCoin(b),c(Convert.toBalance(a)))})},getSupply:function(c){h.totalSupply.call(function(a,b){a?alert(a):c(Convert.toMillion(b))})},usoSend:function(c,a,b,d){b=Convert.toSatoshi(b);b.isGreaterThan(e.getMaxUsoTxLimit())?d(g.Values.Strings.MAX_USO_TX_LIMIT_EXCEEDED):(a=
h.transfer.getData(a,b.toString()),k(c,l,0,a,d))},ethSend:function(c,a,b,d){b=f.toWei(b,"ether");k(c,a,f.toHex(b),null,d)}}})(window);
